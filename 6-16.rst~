
.. _6-16-label:

===============================================================================
問題6.16 - 標準写像
===============================================================================

.. contents::

シミュレーションの目的
============================

標準写像

.. math:: \theta_{n+1} = (\theta_{n} + p_{n}) \qquad \mathrm{modulo} 2\pi
    :label: s1

.. math:: p_{n+1} = p_{n} + k \sin \theta_{n+1}
    :label: s2

は、ハミルトン系の中でも、ある初期状態では規則的で可積分であるが他の条件ではカオス的になるという、混合系ともいえるクラスの単純なモデルである。物理的な実体としては、\ :num:`図#fig-6-16-f1`\ に示されているような回転子を考えている。慣性モーメント\ :math:`I`\ 、長さ\ :math:`L`\ の棒の一端が摩擦のない支点に固定されていて、他端には強さ\ :math:`k/L`\ の周期的な撃力が、時刻\ :math:`t=0,\tau,2\tau, \cdots`\ に鉛直方向に加えられる。回転子の運動は角度\ :math:`\theta`\ とそれに対応する角運動量\ :math:`p_{\theta}`\ で記述される。この系のハミルトニアンは

.. math:: H(\theta, p_{\theta}, t) = \frac{p_{\theta}^{2}}{2I} + k \cos \theta \sum_{n} \delta (t-n\tau)


と書かれる。したがって、対応する運動方程式は、正準方程式を用いて

.. math:: \frac{dp_{\theta}}{dt} = k\sin \theta \sum_{n} \delta (t- n\tau)
    :label: e1

.. math:: \frac{d\theta}{dt} = \frac{p_{\theta}}{I}
    :label: e2


となる。式\ :eq:`e1`\ 、\ :eq:`e2`\ から、\ :math:`p_{\theta}`\ は撃力とつぎの撃力の間では一定(重力はないと仮定している)であるが、撃力が加わるときに不連続的に変化することがわかる。角度\ :math:`\theta`\ は撃力と撃力の間で\ :math:`t`\ の1次で変化し、撃力が加わる瞬間では連続である。
撃力を加えた直後の\ :math:`\theta`\ と\ :math:`p_{\theta}`\ の値を求めると都合がよい。\ :math:`\varepsilon>0`\ を微小量として\ :math:`t=n\tau + \varepsilon`\ における\ :math:`\theta(t)`\ および\ :math:`p_{\theta}(t)`\ の値をそれぞれ\ :math:`\theta_{n}`\ および\ :math:`p_{n}`\ とする。式\ :eq:`e1`\ を\ :math:`t=(n+1)\tau-\varepsilon`\ から\ :math:`t=(n+1)\tau-\varepsilon`\ まで積分すると、

.. math:: p_{n+1} - p_{n}= k\sin \theta_{n+1}


を得る(\ :math:`p`\ は撃力と撃力の間で一定であり、\ :math:`t=(n+1)\tau`\ のときにのみデルタ関数が積分に寄与することに注意が必要である)。式\ :eq:`e2`\ からは

.. math:: \theta_{n+1} - \theta_{n} = (\tau/I)p_{n}

が得られる。\ :math:`\tau/I = 1`\ となるように単位を選ぶと、標準写像\ :eq:`s1`\ ,\ :eq:`s2`\ が得られる。式\ :eq:`s1`\ には角度\ :math:`\theta`\  の値が\ :math:`0`\ と\ :math:`2\pi`\ の間に制限されるという条件(modulo \ :math:`2\pi`\ )を付け加えてある。

.. _fig-6-16-f1:

.. figure:: figure_1.png
    :figclass: align-center
    :width: 10.5cm
    
    撃力が加えられた慣性モーメント\ :math:`I`\ の棒からなる回転子。重力と支点での摩擦は無視する。


式\ :eq:`s1`\ ,\ :eq:`s2`\ の反復計算を行う前に、これらがハミルトン系、つまり\ :math:`n`\ を大きくしていっても\ :math:`q`\ -\ :math:`p`\ 空間における面積が一定であることを確かめておく(ここでは\ :math:`q`\ は\ :math:`\theta`\ を指している)。長さ\ :math:`dq_{n}`\ と\ :math:`dp_{n}`\ の長方形から始めることを考えると、1回の反復の後、この長方形は\ :math:`dq_{n+1}`\ と\ :math:`dp_{n+1}`\ の辺を持つ平行四辺形に変形される。すなわち、


.. math:: dq_{n+1} = dq_{n} + dp_{n}
    :label: e3

.. math:: dp_{n+1} = dp_{n} + k \cos q_{n+1} dq_{n+1}
    :label: e4


である。式\ :eq:`e3`\ に\ :eq:`e4`\ を代入すると、

.. math:: dp_{n+1} = (1 + k \cos q_{n+1})dp_{n} + k\cos q_{n+1} dq_{n}


を得る。ベクトル\ :math:`d\mbox{\boldmath $q$}_{n+1} = (dq_{n}, dp_{n})`\ と\ :math:`d\mbox{\boldmath $p$}_{n+1} = (1 + k\cos q_{n}, k\cos q_{n} dq_{n}))`\ のベクトル積の大きさを計算して平行四辺形の面積を求めると、\ :math:`dq_{n}dp_{n}`\ となり、位相空間内の面積は不変であり、標準写像は保存系であることがわかる。
標準写像の定性的性質については問題6.16で調べることであるが、それらは次のように要約することができる。\ :math:`k=0`\ のとき、棒は運動量\ :math:`p_{n} = p_{0} =`\ 一定によって定まる一定の角運動量で回転する。\ :math:`p_{0}`\ が\ :math:`2\pi`\ の有理数倍のときには、位相空間の軌跡は、水平な線上にある孤立した点列から構成される(共鳴トーラス)。\ :math:`p_{0}`\ が\ :math:`2\pi`\ の有理数倍でないか、コンピュータに十分な精度がないときには、十分に長い時間の後に軌跡は位相空間内の水平な曲線へと変化する。そして共有トーラスに対応する孤立した点列は閉曲線へと変化する。初期条件によっては、過渡的な振る舞いが消えるくらいに十分長い反復の後に、軌跡はカオス的になるだろう。


作成したプログラム
=============================

本シミュレーションで作成・使用したプログラムを以下に示す。

* パラメータの設定ウィンドウ( :download:`SetParameter.py <SetParameter.py>` )

:ref:`問題6.14 <6-14-label>` で使用したものと同じである。

.. literalinclude:: SetParameter.py
    :language: python
    :linenos:


* 標準写像の計算・描画プログラム( :download:`6-16_standard_map.py <6-16_standard_map.py>` )

このプログラムでは、初めのntransient回の計算結果を捨てて、nplot回の反復計算の結果をグラフに表示するプログラムである。プログラムを実行すると、SetParameterのshow_setting_windowが呼び出され、パラメータの設定が行える。OKボタンを押すと、関数staticを介してパラメータの代入とグラフの描画を行う。ここでのカウンタはscatterメソッドが標準で色のループを行わないため、自前で色の制御を行うために追加したものである。実際に写像の計算を行っているのは50行目から63行目であり、あとはグラフの体裁を整えるためのものである。

.. literalinclude:: 6-16_standard_map.py
    :language: python
    :linenos:



実習課題
=====================

a. 標準写像の反復を実行するプログラムを書いて、位相空間の軌跡を描け。\ :math:`k`\ を変えたときの挙動を調べよ。特に、位相空間内の軌道の変化に着目せよ。
 
まず、単純な問題として\ :math:`k=0`\ として固定したとき、初期条件\ :math:`p_{0}`\ の値をさまざまに変えたときの軌跡の様子を\ :num:`図#fig-6-16-f2`\ に示す。この図は、周期的な撃力がないときには、棒は初めの角運動量を保ったまま回転を続けるという事実を再現している。

.. _fig-6-16-f2:

.. figure:: figure_2.png
    :figclass: align-center
    :width: 16.5cm
    
    :math:`k=0`\ のときの位相空間の軌跡


次に、\ :math:`\theta_{0}`\ と\ :math:`p_{0}`\ を固定して、\ :math:`k`\ を\ :math:`k=0.1, 1.0, 1.7, 1.99694994, 1.99694995, 2.0`\ としたときの位相空間の軌跡を\ :num:`図#fig-6-16-f3`\ 、\ :num:`図#fig-6-16-f4`\ に示す。このグラフから、\ :math:`k`\ が大きくなるにつれて曲線や閉曲線であった軌跡が分岐していくようになり、トーラスの島と呼ばれる環状の軌跡が現れる様子も観察される。また、\ :math:`k`\ がある値\ :math:`k=k_{c} \simeq 1.99694995`\ 以上になると、その曲線からさらに離れた位置を取るようになって、カオス的な振る舞いを示すことも分かる。この\ :math:`k_{c}`\ の値は、初期値によって変わることも確かめることができた。

.. _fig-6-16-f3:

.. figure:: figure_3.png
    :figclass: align-center
    :width: 16.5cm
    
    :math:`\theta_{0}=1.5`\ 、\ :math:`p_{0}=0.2`\ としたとき、\ :math:`k`\ による位相空間での軌跡の変化

.. _fig-6-16-f4:

.. figure:: figure_4.png
    :figclass: align-center
    :width: 16.5cm
    
    :math:`\theta_{0}=1.5`\ 、\ :math:`p_{0}=0.2`\ としたとき、\ :math:`k`\ による位相空間での軌跡の変化


まとめ
=======================

ハミルトン系の単純な例である標準写像について、\ :math:`k`\ による位相空間での軌跡の変化を観察することができた。


参考文献
============================

* ハーベイ・ゴールド,ジャン・トボチニク,石川正勝・宮島佐介訳『計算物理学入門』,ピアソン・エデュケーション, 2000.


